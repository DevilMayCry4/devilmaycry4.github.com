<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Page 4 | IOS | 無限大な夢</title>
  <meta name="author" content="virgil">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="無限大な夢"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="無限大な夢" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">無限大な夢</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
<h2 class="archive-title category">IOS</h2>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-04-22T05:46:00.000Z"><a href="/2013/04/22/IOS/2013-04-22-grand-central-dispatch/">Apr 22 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/04/22/IOS/2013-04-22-grand-central-dispatch/">Grand Central Dispatch </a></h1>
  

    </header>
    <div class="entry">
      
        <p><br>Grand Central Dispatch (GCD)是Apple开发的一个多核编程的解决方法。该方法在Mac OS X 10.6雪豹中首次推出，并随后被引入到了iOS4.0中。GCD是一个替代诸如NSThread, NSOperationQueue, NSInvocationOperation等技术的很高效和强大的技术，它看起来象就其它语言的闭包(Closure)一样，但苹果把它叫做blocks<br></p>

<p><br>应用举例<br>让我们来看一个编程场景。我们要在iphone上做一个下载网页的功能，该功能非常简单，就是在iphone上放置一个按钮，点击该按钮时，显示一个转动的圆圈，表示正在进行下载，下载完成之后，将内容加载到界面上的一个文本控件中。不用GCD前<br>虽然功能简单，但是我们必须把下载过程放到后台线程中，否则会阻塞UI线程显示。所以，如果不用GCD, 我们需要写如下3个方法：<font color="red">someClick</font> 方法是点击按钮后的代码，可以看到我们用NSInvocationOperation建了一个后台线程，并且放到NSOperationQueue中。后台线程执行<font color="red">download</font>方法。<br><font color="red">download</font> 方法处理下载网页的逻辑。下载完成后用<font color="red">performSelectorOnMainThread</font>执行<font color="red">download_completed</font> 方法。<br><font color="red">download_completed</font> 进行clear up的工作，并把下载的内容显示到文本控件中。<br><br>这3个方法的代码如下:<br></p>

<blockquote>

<p>-(IBAction)someClick:(id)sender<br>{<br>  self.indicator.hidden = NO;<br>  [self.indicatorstart  Animating];<br>  queue = [[NSOperationQueue  alloc]init];<br>  NSInvocationOperation *op = [[[NSInvocationOperation alloc]initWithTarget:self<br>                                                                   selector:@selector(download)<br>                                                                     object:nil]autorelease];<br>  [queueaddOperation:op];<br> }</p>
<footer><strong>lang:objc</strong></footer></blockquote>

<p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2013/04/22/IOS/2013-04-22-grand-central-dispatch/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-04-22T05:42:00.000Z"><a href="/2013/04/22/IOS/2013-04-22-intxing-zhuan-hua-wei-nsdata/">Apr 22 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/04/22/IOS/2013-04-22-intxing-zhuan-hua-wei-nsdata/">int型和NSdata型互相转化</a></h1>
  

    </header>
    <div class="entry">
      
        <p>int转化成NSdata</p><br><blockquote><br><br>int i =1;<br>NSData *data =[NSDatadataWithBytes:&amp;i length:sizeof(i)];<br><br><footer><strong>lang:objc</strong></footer></blockquote><br><br><br><p>NSdata转化成int</p>

<blockquote>

<p>int i = [data getBytes:&amp;i length:sizeof(i)];</p>
<footer><strong>lang:objc</strong></footer></blockquote>


      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-04-22T04:20:00.000Z"><a href="/2013/04/22/IOS/2013-04-22-zheng-que-chu-li-memory-waring/">Apr 22 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/04/22/IOS/2013-04-22-zheng-que-chu-li-memory-waring/">正确处理Memory Waring</a></h1>
  

    </header>
    <div class="entry">
      
        <p>  IPhone下每个app可用的内存是被限制的，如果一个app使用的内存超过20M，则系统会向该app发送Memory Warning消息。收到此消息后，app必须正确处理，否则可能出错或者出现内存泄露。</p>



      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-04-22T04:10:00.000Z"><a href="/2013/04/22/IOS/2013-04-22-iosshe-bei-huo-qu-ben-ji-ipdi-zhi/">Apr 22 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/04/22/IOS/2013-04-22-iosshe-bei-huo-qu-ben-ji-ipdi-zhi/">IOS设备获取本机IP地址</a></h1>
  

    </header>
    <div class="entry">
      
        <blockquote>

<h1 id="include_">include <ifaddrs.h></ifaddrs.h></h1>
<h1 id="include_-1">include <arpa inet.h=""></arpa></h1>
<ul>
<li><p>(NSString<em>)getIPAddress<br>{<br> NSString</em>address = @”error”;<br> structifaddrs<em>interfaces = NULL;<br> structifaddrs</em>temp_addr = NULL;<br> intsuccess = 0;</p>
<p> // retrieve the current interfaces - returns 0 on success<br> success = getifaddrs(&amp;interfaces);<br> if(success == 0)<br>   {<br> // Loop through linked list of interfaces</p>
<pre><code>  temp_addr = interfaces;
  <span class="keyword">while</span>(temp_addr != <span class="keyword">NULL</span>) 
  {
      <span class="keyword">if</span>( temp_addr<span class="variable">-&gt;ifa_addr</span><span class="variable">-&gt;sa_family</span>== AF_INET) 
      {
</code></pre><p> // Check if interface is en0 which is the wifi connection on the iPhone</p>
<pre><code>           <span class="keyword">if</span>([[<span class="constant">NSStringstringWithUTF8String</span><span class="symbol">:temp_addr-&gt;ifa_name</span>] <span class="symbol">isEqualToString:</span>@<span class="string">"en0"</span>])
          {
</code></pre><p>// Get NSString from C String</p>
<pre><code>             address = [<span class="attribute">NSStringstringWithUTF8String</span>:inet_ntoa<span class="function"><span class="params">(((structsockaddr_in*)temp_addr-&gt;ifa_addr)-&gt;sin_addr)</span>];
          }
      }

      <span class="title">temp_addr</span> = <span class="title">temp_addr</span>-&gt;</span>ifa_next;
  }
</code></pre><p>  }</p>
<p>  // Free memory<br>  freeifaddrs(interfaces);<br>  returnaddress;<br>}</p>
</li>
</ul>
<footer><strong>lang:objc</strong></footer></blockquote>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-04-22T04:03:00.000Z"><a href="/2013/04/22/IOS/2013-04-22-uiviewcontroller-zai-uinavigationcontroller-zhong-,dang-uinavigationbarchu-xian-hou-de-bian-hua/">Apr 22 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/04/22/IOS/2013-04-22-uiviewcontroller-zai-uinavigationcontroller-zhong-,dang-uinavigationbarchu-xian-hou-de-bian-hua/">UIViewController 在UINavigationController 中，当UINavigationBar出现后的变化</a></h1>
  

    </header>
    <div class="entry">
      
        <p>如果UIViewController 是在导航控制器中<br>在navigationbar 出现后self.view 的高度减少了44。如：<br>在viewDidLoad 中 </p>

<blockquote>

<p>NSLog(@”self height %f”,self.view.frame.size.heigt);  </p>
<footer><strong>lang:objc</strong></footer></blockquote>

 <p><br>在viewDidAppear 中 </p><br><blockquote><br><br>NSLog(@”self height %f”,self.view.frame.size.heigt);<br><br><footer><strong>lang:objc</strong></footer></blockquote><br><br><p> 两个结果相差 44。</p>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-04-22T03:38:00.000Z"><a href="/2013/04/22/IOS/2013-04-22-chang-yong-dai-ma/">Apr 22 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/04/22/IOS/2013-04-22-chang-yong-dai-ma/">常用代码</a></h1>
  

    </header>
    <div class="entry">
      
        <p></p><p>1.判断邮箱格式是否正确的代码</p><br>{<blockquote><p></p>
<p>-(BOOL)isValidateEmail:(NSString <em>)email<br>{<br>  NSString </em>emailRegex = @”[A-Z0-9a-z._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}”;<br>  NSPredicate *emailTest = [NSPredicate predicateWithFormat:@”SELF MATCHES%@”,emailRegex];<br>  return [emailTest evaluateWithObject:email];<br>}<blockquote></blockquote></p>
<p></p><p>2.图片压缩</p><blockquote><p></p>
<ul>
<li>(UIImage<em>)imageWithImageSimple:(UIImage</em>)image scaledToSize:(CGSize)newSize<br>{<br>// Create a graphics image context<br> UIGraphicsBeginImageContext(newSize);<br>// Tell the old image to draw in this newcontext, with the desired<br>// new size<br> [image drawInRect:CGRectMake(0,0,newSize.width,newSize.height)];<br>// Get the new image from the context<br> UIImage* newImage = UIGraphicsGetImageFromCurrentImageContext();<br>// End the context<br> UIGraphicsEndImageContext();<br>// Return the new image.<br> return newImage;<br>}<blockquote></blockquote></li>
</ul>
<p></p><p>3.亲测可用的图片上传代码</p><blockquote><p></p>
<ul>
<li>(IBAction)uploadButton:(id)sender<br>{<br> UIImage <em>image = [UIImage imageNamed:@”1.jpg”]; //图片名<br> NSData </em>imageData = UIImageJPEGRepresentation(image,0.5);//压缩比例<br> NSLog(@”字节数:%i”,[imageData length]);<br>// post url<br> NSString <em>urlString = @”<a href="http://192.168.1.113:8090/text/UploadServlet" target="_blank" rel="external">http://192.168.1.113:8090/text/UploadServlet</a>“;<br>//服务器地址<br>// setting up the request object now<br> NSMutableURLRequest </em>request = [[NSMutableURLRequest alloc] init] ;<br> [request setURL:[NSURL URLWithString:urlString]];<br> [request setHTTPMethod:@”POST”];<br>//<br> NSString <em>boundary = [NSString stringWithString:@”—————————————-14737809831466499882746641449”];<br> NSString </em>contentType = [NSString stringWithFormat:@”multipart/form-data;boundary=%@”,boundary];<br> [request addValue:contentType forHTTPHeaderField: @”Content-Type”];<br>//<br> NSMutableData <em>body = [NSMutableData data];<br> [body appendData:[[NSString stringWithFormat:@”\r\n—%@\r\n”,boundary] dataUsingEncoding:NSUTF8StringEncoding]];<br> [body appendData:[[NSString stringWithString:@”Content-Disposition:form-data; name=\”userfile\”; filename=\”2.png\”\r\n”] dataUsingEncoding:NSUTF8StringEncoding]]; //上传上去的图片名字<br> [body appendData:[[NSString stringWithString:@”Content-Type: application/octet-stream\r\n\r\n”] dataUsingEncoding:NSUTF8StringEncoding]];<br> [body appendData:[NSData dataWithData:imageData]];<br> [body appendData:[[NSString stringWithFormat:@”\r\n—%@—\r\n”,boundary] dataUsingEncoding:NSUTF8StringEncoding]];<br> [request setHTTPBody:body];<br>// NSLog(@”1-body:%@”,body);<br> NSLog(@”2-request:%@”,request);<br> NSData </em>returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];<br> NSString *returnString = [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];<br> NSLog(@”3-测试输出：%@”,returnString);</li>
</ul>
<footer><strong>lang:objc</strong></footer></blockquote>


      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2013/04/22/IOS/2013-04-22-chang-yong-dai-ma/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-04-22T03:36:00.000Z"><a href="/2013/04/22/IOS/2013-04-22-she-uiimagewei-backgroundcolor/">Apr 22 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/04/22/IOS/2013-04-22-she-uiimagewei-backgroundcolor/">设UIImage为backgroundColor</a></h1>
  

    </header>
    <div class="entry">
      
        <blockquote>


<ul>
<li>(UIColor<em>)colorWithPatternImage:(UIImage</em>)image;</li>
</ul>
<footer><strong>lang:objc</strong></footer></blockquote>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-04-22T03:26:00.000Z"><a href="/2013/04/22/IOS/2013-04-22-ioshuo-qu-dan-wen-jian-de-da-xiao/">Apr 22 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/04/22/IOS/2013-04-22-ioshuo-qu-dan-wen-jian-de-da-xiao/">IOS获取单文件的大小</a></h1>
  

    </header>
    <div class="entry">
      
        <p>c语言实现：</p><br><blockquote><br><br>#include “sys/stat.h”<br>- (long long) fileSizeAtPath:(NSString*) filePath<br>{<br>    struct stat st;<br>    if(lstat([filePath cStringUsingEncoding:NSUTF8StringEncoding], &amp;st) == 0)<br>    {<br>        return st.st_size;<br>    }<br>    return 0;<br>}<br><br><br><footer><strong>lang:objc</strong></footer></blockquote><br><br><br><p>object-c实现：</p>

<blockquote>


<p>-(long long) fileSizeAtPath:(NSString<em>) filePath<br>{<br>  NSFileManager</em> manager = [NSFileManager defaultManager];<br>  if ([manager fileExistsAtPath:filePath])<br>  {<br>    return [[manager attributesOfItemAtPath:filePath error:nil] fileSize];<br>  }<br>  return 0;<br>}  </p>
<footer><strong>lang:objc</strong></footer></blockquote>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-04-22T03:18:00.000Z"><a href="/2013/04/22/IOS/2013-04-22-svn-shang-chuan-dot-awen-jian/">Apr 22 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/04/22/IOS/2013-04-22-svn-shang-chuan-dot-awen-jian/">svn 上传.a文件</a></h1>
  

    </header>
    <div class="entry">
      
        <p>1. 在每个用户主文件夹下有一个名为.subversion的隐藏文件夹，打开里面的config文件。</p><br><p>2. 查找 [miscellany] 字段，即可看到下面有个 global-ignores 键名，默认为注释掉了的，这表示SVN已经将它们作为默认值了。</p><br><p>3. 取消注释，把 <em>.so </em>.so.[0-9]<em> </em>.a 去掉，当然你也可以根据需要增加或减少你的过滤选项。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-04-21T12:46:00.000Z"><a href="/2013/04/21/IOS/2013-04-21-ios-jian-ce-er-ji-cha-ru/">Apr 21 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/04/21/IOS/2013-04-21-ios-jian-ce-er-ji-cha-ru/">IOS 检测耳机插入</a></h1>
  

    </header>
    <div class="entry">
      
           <blockquote>

<p>UInt32 dataSize;<br>CFStringRef currentRoute;<br>currentRoute = NULL;<br>dataSize = sizeof(CFStringRef);<br>AudioSessionInitialize(NULL, NULL, NULL, NULL);<br>AudioSessionGetProperty(kAudioSessionProperty_AudioRoute, &amp;dataSize, &amp;currentRoute);<br>if([(NSString *) currentRoute hasPrefix: @”Headphone”])<br>{<br>    //插入耳机后想执行的操作<br>}<blockquote></blockquote></p>
</blockquote>




      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  

  <nav id="pagination">
  
    <a href="/categories/IOS/page/3/" class="alignleft prev">Prev</a>
  
  
    <a href="/categories/IOS/page/5/" class="alignright next">Next</a>
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/IOS/">IOS</a><small>44</small></li>
  
    <li><a href="/categories/OSX/">OSX</a><small>1</small></li>
  
    <li><a href="/categories/Other/">Other</a><small>4</small></li>
  
    <li><a href="/categories/windowsphone/">windowsphone</a><small>5</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/IOS/">IOS</a><small>16</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2014 virgil
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>